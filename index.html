<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.0.3/tailwind.min.css">
</head>
<body class="bg-gray-500">
    <div class="heading text-center font-bold text-2xl m-5 text-gray-100">Star Wars Characters</div>
        <div id="star-wars" class="holder mx-auto w-10/12 grid sm:grid-cols-1 md:grid-cols-3 lg:grid-cols-4"></div>
    </div>
    <script>
    
        const PEOPLE_URL = 'https://swapi.dev/api/people/';
        const PLANET_URL = 'https://swapi.dev/api/planets/';

        let numOfPeoplePages = 9;
        let peopleDataArray = [1, 2, 3, 4, 5, 6, 7, 8, 9];

        let numOfPlanetPages = 6;
        let planetDataArray = [1, 2, 3, 4, 5, 6];

        async function getPeopleData(PEOPLE_URL) {
            console.time('.map()')
            Promise.all(
                peopleDataArray.map(id => {
                    return new Promise((resolve) => {
                    fetch(PEOPLE_URL + `?page=${numOfPeoplePages}`)
                        .then(response => {
                        return new Promise(() => {
                            response.json()
                            .then(todo => {
                                todo.results.forEach( element =>  {
                                    peopleDataArray.push(element)
                                })
                                resolve()
                            })
                        })
                        })
                        numOfPeoplePages--;
                    })
                })
            ).then(() => {
                Promise.all(
                planetDataArray.map(id => {
                    return new Promise((resolve) => {
                    fetch(PLANET_URL + `?page=${numOfPlanetPages}`)
                        .then(response => {
                        return new Promise(() => {
                            response.json()
                            .then(todo => {
                                todo.results.forEach( element =>  {
                                    planetDataArray.push(element)
                                })
                                resolve()
                            })
                        })
                        })
                        numOfPlanetPages--;
                    })
                })
            )})
            .then(() => {
                let array3 = peopleDataArray.filter( obj => { 
                    console.log(obj)
                    return planetDataArray.indexOf(obj) == -1; 
                });
            })
            .then(() => {
                createMainDataObject();
                console.timeEnd('.map()');
            })
        }

        async function createMainDataObject() {
            let starWars = '';
            let finalData = peopleDataArray.slice(10,100);
            finalData.forEach( element => {
                starWars += `
                    <div class="each mb-10 m-2 shadow-lg border-gray-800 bg-gray-100 relative">
                        <img class="w-full" src="https://i.pinimg.com/originals/ab/59/08/ab59083db9af54986221c5c1409e26a9.gif" alt="" />
                        <div class="badge absolute top-0 right-0 bg-red-500 m-1 text-gray-200 p-1 px-2 text-xxl font-bold rounded">In Development</div>
                        <div class="info-box text-xs flex p-1 font-semibold text-gray-500 bg-gray-300">
                            <span class="mr-1 p-1 px-2 font-bold">Height ${element.height}</span>
                            <span class="mr-1 p-1 px-2 font-bold border-l border-gray-400">Mass ${element.mass}</span>
                            <span class="mr-1 p-1 px-2 font-bold border-l border-gray-400">DOB ${element.birth_year}</span>
                        </div>
                        <div class="desc p-4 text-gray-800">
                            <a href="https://www.youtube.com/watch?v=dvqT-E74Qlo" target="_new" class="title font-bold block cursor-pointer hover:underline">${element.name}</a>
                            <a href="" target="_new" class="badge bg-indigo-500 text-blue-100 rounded px-1 text-xs font-bold cursor-pointer">${element.home_world}</a>
                            <span class="description text-sm block py-2 border-gray-400 mb-2">Star Wars API: Pulling character information.  Working on scraping images to use for the charcter profile.</span>
                        </div>
                    </div>
                `
            })
            document.getElementById('star-wars').innerHTML += starWars;
            // console.log(peopleDataArray)
        }

        async function findHomeWorld(homeworld) {
            console.log(homeworld)
        }

        getPeopleData(PEOPLE_URL);

        // async function returnHomeWorldValues() {
        //     await createMainDataObject();
        //     console.log(peopleDataArray)
        //     const planetData = await getData(PLANET_URL);
        //     peopleDataArray.forEach(obj => {
        //         const url = obj.character.home_worldURL;
        //         planetData.results.forEach( element => {
        //         if (element.url === url) {
        //             obj.character['home_world'].name = element.name;
        //             obj.character['home_world'].terrain = element.terrain;
        //             obj.character['home_world'].climate = element.climate;
        //             }
        //         })
        //     });

        //     let starWars = '';

        //     peopleDataArray.forEach( element => {
        //         starWars += `
        //             <div class="each mb-10 m-2 shadow-lg border-gray-800 bg-gray-100 relative">
        //                 <img class="w-full" src="https://i.pinimg.com/originals/ab/59/08/ab59083db9af54986221c5c1409e26a9.gif" alt="" />
        //                 <div class="badge absolute top-0 right-0 bg-red-500 m-1 text-gray-200 p-1 px-2 text-xxl font-bold rounded">In Development</div>
        //                 <div class="info-box text-xs flex p-1 font-semibold text-gray-500 bg-gray-300">
        //                     <span class="mr-1 p-1 px-2 font-bold">Height ${element.character.height}</span>
        //                     <span class="mr-1 p-1 px-2 font-bold border-l border-gray-400">Mass ${element.character.mass}</span>
        //                     <span class="mr-1 p-1 px-2 font-bold border-l border-gray-400">DOB ${element.character.birth_year}</span>
        //                 </div>
        //                 <div class="desc p-4 text-gray-800">
        //                     <a href="https://www.youtube.com/watch?v=dvqT-E74Qlo" target="_new" class="title font-bold block cursor-pointer hover:underline">${element.character.name}</a>
        //                     <a href="" target="_new" class="badge bg-indigo-500 text-blue-100 rounded px-1 text-xs font-bold cursor-pointer">${element.character.home_world.name}</a>
        //                     <span class="description text-sm block py-2 border-gray-400 mb-2">Star Wars API: Pulling character information.  Working on scraping images to use for the charcter profile.</span>
        //                 </div>
        //             </div>
        //         `
        //     })
        //     document.getElementById('star-wars').innerHTML += starWars;
        // }
        // returnHomeWorldValues();

    </script>
    <!-- <script src="dist/js/app.js"></script> -->
    <!-- <script src="dist/js/helper.js"></script>-->
</body>
</html>